'use client';
import React from "react";
import DefaultLayout from "@/components/Layouts/DefaultLayout";
import HeroImage from "@/components/HeroImage";
import Image from "next/image";
import { Testimonial, TestimonialType } from "@/interfaces/TestimonialInterfaces";
import VideoTestimonial from "./video-testimonial";

interface TestimonialsProps {
    initialData: Testimonial[];
}

const Testimonials: React.FC<TestimonialsProps> = ({ initialData }) => {

    const titleLineStyles: React.CSSProperties = {
        height: '2px',
        width: '31px',
        backgroundColor: '#10242C',
        display: 'block',
        position: 'absolute',
        top: '-24px',
    }

    const [data, setData] = React.useState<Testimonial[]>(initialData);
    console.log(data);

    const testimonialsText = data.filter((item: Testimonial) => item.testimonialType === TestimonialType.TEXT && item.showOnTestimonials);
    const testimonialsVideo = data.filter((item: Testimonial) => item.testimonialType === TestimonialType.VIDEO && item.showOnTestimonials);

    const renderStars = (rating: number | undefined) => {
        const starCount = rating ?? 5;
        return Array.from({ length: 5 }, (_, index) => (
            <svg
                key={index}
                width="17"
                height="16"
                viewBox="0 0 17 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                className={`${
                    index < starCount ? "text-[#B39852]" : "text-gray-300"
                } inline-block`}
            >
                <path
                    d="M7.49155 0.784599C7.70929 0.114455 8.65737 0.114455 8.87511 0.784598L10.3063 5.18942C10.4037 5.48911 10.683 5.69203 10.9981 5.69203H15.6296C16.3342 5.69203 16.6272 6.5937 16.0571 7.00787L12.3102 9.7302C12.0552 9.91542 11.9486 10.2437 12.0459 10.5434L13.4772 14.9483C13.6949 15.6184 12.9279 16.1757 12.3578 15.7615L8.61087 13.0392C8.35594 12.8539 8.01072 12.8539 7.75579 13.0392L4.00882 15.7615C3.43876 16.1757 2.67176 15.6184 2.8895 14.9483L4.32071 10.5434C4.41809 10.2437 4.31141 9.91542 4.05647 9.7302L0.309512 7.00787C-0.260546 6.5937 0.0324247 5.69203 0.737055 5.69203H5.36856C5.68368 5.69203 5.96296 5.48911 6.06034 5.18942L7.49155 0.784599Z"
                    fill={index < starCount ? "#B39852" : "#D1D5DB"} // Gold for filled stars, gray for empty stars
                />
            </svg>
        ));
    };

    return (
        <DefaultLayout>
            <main>
                {/* Hero Section */}
                <HeroImage src={'/testimonial-hero.png'} alt={'Testimonials'} title={'Testimonials'} />



                <div className="container mx-auto mb-12 px-4 md:px-0 mt-24">
                    <h2 className="text-3xl font-bold text-[#10242C] mb-6 relative">
                        <div style={titleLineStyles}></div>
                        Video testimonial
                    </h2>

                    <div className="relative">
                        <VideoTestimonial testimonials={testimonialsVideo}/>
                    </div>
                </div>

                {/* Card Testimonials Section */}
                <section
                    className="relative bg-cover bg-center bg-no-repeat py-12 lg:py-24 xl:py-52"
                    style={{ backgroundImage: `url('/testimonial.png')` }}
                >
                    <div className="absolute inset-0 bg-gradient-to-b from-transparent to-black/40"></div>
                    <div className="relative container mx-auto px-8">
                        <div className="grid grid-cols-1 md:grid-cols-3 xl:grid-cols-5 gap-5">
                            {testimonialsText.map((testimonial, index) => (
                                <div
                                    key={index}
                                    style={{ boxShadow: '0px 28.93px 63.5px 0px #450E1529' }}
                                    className="col-span-1 bg-white flex flex-col justify-between"
                                >
                                    <div>
                                        <div className="flex space-x-1 items-center justify-between p-4">
                                            <span className="flex items-center">{renderStars(testimonial.rating || 5)}</span>
                                            <span>
                                            <svg width="89" height="22" viewBox="0 0 89 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M23.6484 8.20972V6.83228H30.1377V8.20972H27.7187V14.7328H26.0674V8.20972H23.6484Z" fill="#202020"/>
                                                <path d="M33.8778 14.8487C33.2717 14.8487 32.7488 14.7245 32.3084 14.4761C31.8681 14.2277 31.5294 13.8763 31.2923 13.4205C31.0566 12.9632 30.9395 12.4227 30.9395 11.7975C30.9395 11.1878 31.0566 10.6536 31.2923 10.1942C31.5294 9.7334 31.8632 9.37422 32.2943 9.11595C32.7248 8.85838 33.2314 8.72925 33.8129 8.72925C34.3337 8.72925 34.8043 8.84074 35.2242 9.06232C35.6455 9.28248 35.9793 9.61697 36.2262 10.0644C36.4746 10.5103 36.5988 11.0685 36.5988 11.7382V12.1898H32.5625V12.1954C32.5625 12.6379 32.6824 12.9858 32.9238 13.2398C33.1665 13.4939 33.4939 13.6209 33.906 13.6209C34.1805 13.6209 34.4176 13.5637 34.6173 13.4487C34.8185 13.3323 34.9603 13.1608 35.0436 12.935L36.5621 13.0366C36.4471 13.5863 36.1543 14.0259 35.6843 14.3548C35.2136 14.6843 34.6117 14.8487 33.8778 14.8487ZM32.5625 11.1708H35.052C35.0478 10.8194 34.9342 10.5294 34.7105 10.3015C34.4861 10.0721 34.1954 9.95709 33.8383 9.95709C33.4728 9.95709 33.1736 10.0756 32.9407 10.3127C32.7071 10.5484 32.5808 10.8342 32.5625 11.1708Z" fill="#202020"/>
                                                <path d="M42.5999 10.4962L41.0954 10.5894C41.0538 10.3995 40.9494 10.2365 40.7821 10.101C40.6163 9.96415 40.3905 9.895 40.1047 9.895C39.8507 9.895 39.6347 9.94863 39.4583 10.0559C39.2812 10.1617 39.1944 10.3036 39.1986 10.4821C39.1944 10.6232 39.2501 10.7432 39.3652 10.8406C39.4795 10.9387 39.6742 11.017 39.9494 11.0749L41.022 11.2922C42.1624 11.5258 42.7333 12.06 42.7354 12.8955C42.7354 13.285 42.6211 13.6265 42.3938 13.9201C42.1659 14.2122 41.8533 14.4394 41.4567 14.6031C41.0616 14.7669 40.6078 14.8487 40.0962 14.8487C39.3115 14.8487 38.6856 14.685 38.2192 14.3576C37.7541 14.0287 37.4832 13.5814 37.4062 13.0168L39.0236 12.9321C39.0744 13.1735 39.193 13.3555 39.3793 13.4797C39.567 13.6025 39.8069 13.6632 40.099 13.6632C40.3884 13.6632 40.6212 13.6068 40.7962 13.4939C40.9726 13.3809 41.0623 13.237 41.0644 13.062C41.0566 12.7684 40.8033 12.5723 40.3051 12.4721L39.2777 12.2688C38.1317 12.0395 37.5601 11.475 37.5643 10.5753C37.5622 10.0037 37.7908 9.55275 38.2502 9.22321C38.7089 8.89437 39.3179 8.72925 40.0765 8.72925C40.8252 8.72925 41.4151 8.88732 41.8463 9.20345C42.2767 9.51959 42.5279 9.95074 42.5999 10.4962Z" fill="#202020"/>
                                                <path d="M46.9233 8.80846V10.0419H45.8083V12.9126C45.8083 13.1384 45.8591 13.2922 45.9608 13.3727C46.0638 13.4517 46.1986 13.4912 46.3644 13.4912C46.4413 13.4912 46.5182 13.4849 46.5959 13.4714C46.6728 13.4566 46.732 13.4453 46.7737 13.4376L47.0305 14.6598C46.9494 14.6866 46.8337 14.7162 46.6834 14.7501C46.5345 14.7854 46.3538 14.8073 46.1414 14.815C45.543 14.839 45.0632 14.7099 44.7019 14.4255C44.3406 14.1418 44.1613 13.7085 44.1656 13.1271V10.0419H43.3555V8.80846H44.1656V7.38867H45.8083V8.80846H46.9233Z" fill="#202020"/>
                                                <path d="M47.9907 14.733V8.80832H49.6363V14.733H47.9907ZM48.7359 8.04339C48.4946 8.04339 48.2871 7.96153 48.1121 7.79782C47.9371 7.63411 47.8496 7.43864 47.8496 7.21071C47.8496 6.98137 47.9371 6.78591 48.1121 6.62361C48.2871 6.46201 48.4946 6.38086 48.7359 6.38086C48.9801 6.38086 49.1904 6.46201 49.3654 6.62361C49.5404 6.78591 49.6279 6.98137 49.6279 7.21071C49.6279 7.43864 49.5404 7.63411 49.3654 7.79782C49.1904 7.96153 48.9801 8.04339 48.7359 8.04339Z" fill="#202020"/>
                                                <path d="M50.9453 14.733V8.80828H52.5119V9.85266H52.5824C52.7066 9.50265 52.9127 9.22815 53.2006 9.02845C53.4899 8.82945 53.8343 8.72925 54.2337 8.72925C54.6401 8.72925 54.9852 8.83086 55.2696 9.03409C55.5554 9.23591 55.7466 9.50829 55.8426 9.85266H55.9047C56.0246 9.51394 56.2441 9.24226 56.5624 9.03692C56.8799 8.83227 57.2567 8.72925 57.6914 8.72925C58.2425 8.72925 58.6913 8.90566 59.0378 9.25708C59.3836 9.60709 59.5572 10.1039 59.5572 10.7474V14.733H57.9172V11.072C57.9172 10.7432 57.8297 10.4962 57.6547 10.3325C57.4797 10.1674 57.261 10.0841 56.9999 10.0841C56.7007 10.0841 56.4671 10.1794 56.2998 10.3692C56.134 10.5597 56.0515 10.8081 56.0515 11.1144V14.733H54.4567V11.0382C54.4567 10.7467 54.3734 10.5153 54.2083 10.3438C54.0424 10.1709 53.8244 10.0841 53.5534 10.0841C53.2803 10.0841 53.0517 10.1843 52.8675 10.3833C52.6826 10.583 52.5909 10.8476 52.5909 11.1765V14.733H50.9453Z" fill="#202020"/>
                                                <path d="M63.531 14.8487C62.9305 14.8487 62.4118 14.721 61.9757 14.4648C61.5411 14.2094 61.2052 13.8516 60.9681 13.3922C60.7324 12.9336 60.6152 12.4001 60.6152 11.7918C60.6152 11.1807 60.7324 10.6451 60.9681 10.1857C61.2052 9.72705 61.5411 9.36928 61.9757 9.11313C62.4118 8.85768 62.9305 8.72925 63.531 8.72925C64.1294 8.72925 64.6467 8.85768 65.0835 9.11313C65.5196 9.36928 65.8555 9.72705 66.0911 10.1857C66.3282 10.6451 66.4468 11.1807 66.4468 11.7918C66.4468 12.4001 66.3282 12.9336 66.0911 13.3922C65.8555 13.8516 65.5196 14.2094 65.0835 14.4648C64.6467 14.721 64.1294 14.8487 63.531 14.8487ZM63.5395 13.5757C63.9459 13.5757 64.2536 13.4064 64.4625 13.0676C64.6714 12.7275 64.7758 12.2985 64.7758 11.7805C64.7758 11.2654 64.6714 10.837 64.4625 10.4962C64.2536 10.154 63.9459 9.9825 63.5395 9.9825C63.1253 9.9825 62.8119 10.154 62.5995 10.4962C62.3886 10.837 62.2834 11.2654 62.2834 11.7805C62.2834 12.2985 62.3886 12.7275 62.5995 13.0676C62.8119 13.4064 63.1253 13.5757 63.5395 13.5757Z" fill="#202020"/>
                                                <path d="M69.1651 11.3063V14.733H67.5195V8.80828H69.0861V9.85266H69.1567C69.29 9.50829 69.5102 9.23591 69.8172 9.03409C70.1255 8.83086 70.4988 8.72925 70.9377 8.72925C71.5545 8.72925 72.0499 8.92895 72.4224 9.32765C72.7964 9.72493 72.9841 10.269 72.9841 10.9591V14.733H71.3414V11.2527C71.3428 10.89 71.2496 10.6063 71.0619 10.4031C70.8735 10.1984 70.6145 10.0954 70.2857 10.0954C69.9541 10.0954 69.6852 10.202 69.4784 10.4144C69.271 10.6275 69.1665 10.9246 69.1651 11.3063Z" fill="#202020"/>
                                                <path d="M74.272 14.733V8.80832H75.9176V14.733H74.272ZM75.0172 8.04339C74.7758 8.04339 74.5684 7.96153 74.3934 7.79782C74.2184 7.63411 74.1309 7.43864 74.1309 7.21071C74.1309 6.98137 74.2184 6.78591 74.3934 6.62361C74.5684 6.46201 74.7758 6.38086 75.0172 6.38086C75.2613 6.38086 75.4716 6.46201 75.6466 6.62361C75.8216 6.78591 75.9091 6.98137 75.9091 7.21071C75.9091 7.43864 75.8216 7.63411 75.6466 7.79782C75.4716 7.96153 75.2613 8.04339 75.0172 8.04339Z" fill="#202020"/>
                                                <path d="M78.9185 14.8459C78.3519 14.8459 77.8826 14.6984 77.5101 14.4027C77.1375 14.1057 76.9512 13.6646 76.9512 13.0789C76.9512 12.6372 77.0542 12.29 77.2617 12.0374C77.4705 11.7855 77.7443 11.6013 78.083 11.4841C78.4218 11.3656 78.7866 11.2887 79.1782 11.2527C79.6919 11.2019 80.0589 11.1482 80.2791 11.0918C80.5006 11.0353 80.6121 10.9111 80.6121 10.7192V10.6966C80.6121 10.4525 80.5345 10.2633 80.3807 10.1293C80.2282 9.9959 80.0116 9.92887 79.7315 9.92887C79.4358 9.92887 79.2008 9.99379 79.0258 10.1236C78.8508 10.2521 78.7351 10.4144 78.6786 10.6119L77.16 10.4877C77.273 9.94792 77.5531 9.51959 78.0012 9.20345C78.4507 8.88732 79.03 8.72925 79.7399 8.72925C80.1803 8.72925 80.591 8.79911 80.9734 8.93812C81.3573 9.07784 81.6664 9.29519 81.9021 9.59015C82.1371 9.88371 82.2549 10.2662 82.2549 10.7361V14.733H80.6968V13.9116H80.6516C80.5063 14.1868 80.2903 14.4112 80.0024 14.5862C79.7159 14.7591 79.3546 14.8459 78.9185 14.8459ZM79.3899 13.7112C79.7491 13.7112 80.0448 13.6068 80.2762 13.3979C80.5077 13.1876 80.6234 12.9265 80.6234 12.616V11.9866C80.5592 12.0303 80.4597 12.0684 80.3242 12.1023C80.1887 12.1362 80.0448 12.1658 79.8924 12.1898C79.7399 12.2145 79.603 12.235 79.4831 12.2519C79.1952 12.2935 78.9623 12.3747 78.7859 12.4946C78.6088 12.6153 78.5206 12.791 78.5206 13.0225C78.5206 13.2504 78.6024 13.4226 78.7661 13.539C78.9298 13.654 79.1373 13.7112 79.3899 13.7112Z" fill="#202020"/>
                                                <path d="M85.1768 6.83228V14.7328H83.5312V6.83228H85.1768Z" fill="#202020"/>
                                                <path d="M10.926 2.51855C6.32511 2.51855 2.5957 6.24867 2.5957 10.8489C2.5957 15.4497 6.32511 19.1791 10.926 19.1791C15.5262 19.1791 19.2563 15.449 19.2563 10.8489C19.2563 6.24867 15.5262 2.51855 10.926 2.51855ZM8.88524 13.0858C8.88524 13.536 8.52041 13.9001 8.07091 13.9001C7.6207 13.9001 7.25658 13.536 7.25658 13.0858V9.61395C7.25658 9.16374 7.6207 8.79891 8.07091 8.79891C8.52041 8.79891 8.88524 9.16374 8.88524 9.61395V13.0858ZM14.6378 13.0272C14.6378 13.6637 14.2659 13.8917 13.6294 13.8917H10.7009C10.0644 13.8917 9.54856 13.3758 9.54856 12.7393V9.85881C9.54856 9.85881 9.4914 9.37967 10.0221 8.92946C10.322 8.67472 10.7672 8.18852 11.0784 7.59859C11.6966 6.42649 12.0663 6.08495 12.3479 6.17669C13.3909 6.5147 12.8694 8.0608 12.5328 8.70647H13.4854C14.1212 8.70647 14.6378 9.22231 14.6378 9.85881V13.0272Z" fill="#B39852"/>
                                            </svg>
                                        </span>
                                        </div>
                                        <p className="text-black font-ubuntu leading-6 p-6">{testimonial.content}</p>
                                    </div>
                                    <div className="bg-[#B39852] flex items-center gap-4 px-4 py-5 mt-6">
                                        {
                                            testimonial.media && (
                                                <Image
                                                    src={testimonial.media.url}
                                                    alt={testimonial.authorName}
                                                    width={50} // Corresponding to "w-12" (12 x 4 = 48px)
                                                    height={50} // Corresponding to "h-12" (12 x 4 = 48px)
                                                    className="rounded-full object-cover"
                                                />
                                            )
                                        }
                                        <div className="flex flex-col">
                                            <h3 className="font-bold text-white text-sm mb-0">{testimonial.authorName}</h3>
                                            <span className="font-bold text-[#E2E2E2] text-xs">{testimonial.position}</span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </section>
            </main>
        </DefaultLayout>
    );
}

export default Testimonials;